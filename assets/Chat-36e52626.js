import{_ as C}from"./TopBar.vue_vue_type_style_index_0_lang-e9176c74.js";import{q as h,z as u,M as _,s as d,J as r,L as w,B,r as b,h as x,w as T,o as D,m as L,F as M,N as I,t as N,X as V,Z as $,u as p,A as S,n as j}from"./@vue-64dd07d0.js";import{r as q,b as g}from"./@varlet-7ae03b61.js";import{a as f}from"./index-87596f9d.js";import{u as z}from"./user-130e8ee1.js";import{s as A}from"./pinia-2579c363.js";import{l as E}from"./socket.io-client-60b81a72.js";import"./decimal.js-d133ee8e.js";import"./dayjs-ee28432e.js";import"./@popperjs-974c24ae.js";import"./vue-router-bac0c6f6.js";import"./amfe-flexible-ec0a06bf.js";import"./highlight.js-9e946018.js";import"./vue-demi-71ba0ef2.js";import"./engine.io-client-b8dcd8ee.js";import"./engine.io-parser-a5b7cb40.js";import"./@socket.io-3e1df240.js";import"./socket.io-parser-84f3f82f.js";const F={class:"chat-content"},K=h({__name:"ChatCell",props:{msg:null,timestamp:null,photo:null,type:{type:Boolean}},setup(a){return(n,l)=>{const o=q;return u(),_("li",{class:B(["chat-cell",a.type?"user":"robot"])},[d(o,{src:a.photo},null,8,["src"]),r("div",F,w(a.msg),1)],2)}}});const U=f(K,[["__scopeId","data-v-1118f62d"]]),J=E("ws://geek.itheima.net",{query:{token:localStorage.getItem("token")},transports:["websocket"]}),c=J;function R(a,n,l){let o=!1;return()=>{o?g.warning(l):(o=!0,a(),setTimeout(()=>{o=!1},n))}}const X={id:"chat-page"},Z={id:"chat-history"},G={id:"chat-bottom"},H=h({__name:"Chat",setup(a){let n=null;const{userBaseData:l}=A(z()),o=b([{timestamp:1,type:!1,msg:"你好!",photo:"https://varlet.gitee.io/varlet-ui/cat.jpg"}]),m=x("");function v(){const s=m.value;if(!s){g.warning("请输入有效字符!");return}const t={msg:s,timestamp:+new Date};c.emit("message",t),t.type=!0,t.photo=l.value.photo,o.push(t),m.value=""}const i=R(v,2500,"发送消息太频繁了，休息一会吧~");c.on("message",s=>{o.push({msg:s.msg,timestamp:s.timestamp,type:!1,photo:"https://varlet.gitee.io/varlet-ui/cat.jpg"})});function y(){const s=n[n.length-1];setTimeout(()=>{s.scrollIntoView({behavior:"smooth"})},500)}return T(o,()=>{j(()=>{y()})}),D(()=>{n=document.getElementsByClassName("chat-cell"),c.open()}),L(()=>{c.close()}),(s,t)=>{const k=C;return u(),_("div",X,[d(k,{title:"小蓝同学"}),r("ul",Z,[(u(!0),_(M,null,I(o,e=>(u(),S(U,{type:e.type,timestamp:e.timestamp,msg:e.msg,photo:e.photo,key:e.timestamp},null,8,["type","timestamp","msg","photo"]))),128))]),r("div",G,[N(r("input",{onKeyup:t[0]||(t[0]=$((...e)=>p(i)&&p(i)(...e),["enter"])),"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),placeholder:"请输入内容"},null,544),[[V,m.value]]),r("button",{onClick:t[2]||(t[2]=(...e)=>p(i)&&p(i)(...e))},"发送")])])}}});const _t=f(H,[["__scopeId","data-v-24d982b5"]]);export{_t as default};
